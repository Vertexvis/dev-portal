---
id: collaboration-apis
title: Collaboration APIs
description: Use Vertex Platform's collaboration APIs to communicate with team members.
---

This guide explains the core concepts and API usage for enabling collaboration
within your application using the Vertex Collaboration APIs. These APIs allow
your users to participate in structured discussions through contexts, threads,
and replies.

:::note
This guide assumes that you have already configured authentication for
your deployment. Some APIs require a user access token obtained via [token
exchange](./authentication#token-exchange-rfc8693).
:::

## Core Concepts

### Collaboration Context

A **Collaboration Context** is a container for discussions related to a specific
resource â€” such as a 3D model, a project, or a design session. Each context
defines who can participate via one or more associated **User Groups**.

### Thread

A **Thread** represents a focused discussion within a collaboration context.
Each thread has two important properties that help categorize and manage
discussions:

- **Type:** A thread can be either an `issue` or a `comment`. An `issue` thread
  is typically used to flag problems, bugs, or actionable items that may require
  resolution. A `comment` thread is intended for general discussion, feedback,
  or non-blocking remarks.

- **Status:** Threads have a status that indicates their current state. An
  `open` thread signifies an active discussion or unresolved issue, while a
  `resolved` thread indicates that the topic has been addressed or closed.

### Reply

A **Reply** is an individual message within a thread. Users can reply to threads
to continue discussions, provide updates, or give feedback.


### Attachment

An **Attachment** is an additional linked relationship to a reply or a thread. Users can attach
files and other kinds of data to be provided as additional context for a thread or reply.


## Access Control

- Only users in the user groups associated with a context can interact with its
  threads and replies.
- Threads and replies **require a user access token** obtained through an
  RFC8693-compliant [token exchange process](./authentication#token-exchange-rfc8693).
- Collaboration contexts are managed using **application-level access tokens**.

## API Usage

:::note
If calling these APIs from a browser, your deployment will need the
`CorsOrigin` CloudFormation parameter for your deployment.
:::

See our [API reference](https://docs.vertex3d.com) for more details and examples
of the Collaboration APIs.

### Collaboration Contexts

| Operation                          | Endpoint                                        | Auth      |
| ---------------------------------- | ----------------------------------------------- | --------- |
| Create a context                   | `POST /collaboration-contexts`                  | App token |
| Associate user groups to a context | `POST /collaboration-contexts/{id}/user-groups` | App token |
| List all contexts                  | `GET /collaboration-contexts`                   | App token |
| Get a context by ID                | `GET /collaboration-contexts/{id}`              | App token |

### Threads

| Operation               | Endpoint                                           | Auth       |
| ----------------------- | -------------------------------------------------- | ---------- |
| Create a thread         | `POST /threads`                                    | User token |
| List threads by context | `GET /threads?filter[collaborationContextId]={id}` | User token |
| Get thread by ID        | `GET /threads/{id}`                                | User token |
| Update a thread         | `PATCH /threads/{id}`                              | User token |
| Delete a thread         | `DELETE /threads/{id}`                             | User token |

### Replies

| Operation              | Endpoint                             | Auth       |
| ---------------------- | ------------------------------------ | ---------- |
| Create a reply         | `POST /replies`                      | User token |
| List replies in thread | `GET /replies?filter[threadId]={id}` | User token |
| Get reply by ID        | `GET /replies/{id}`                  | User token |
| Update a reply         | `PATCH /replies/{id}`                | User token |
| Delete a reply         | `DELETE /replies/{id}`               | User token |


### Attachments

| Operation                                | Endpoint                                                                                                        | Auth       |
| ---------------------------------------- | --------------------------------------------------------------------------------------------------------------- | ---------- |
| Create an attachment                     | `POST /attachments`                                                                                             | User token |
| List attachments for a thread or reply.  | `GET /attachments?filter[relationshipId]={threadOrReplyId}&filter[relationshipType]=threadOrReply`              | User token |
| Create upload URL for file attachment    | `POST /attachments/{attachmentId}/upload-url`                                                                   | User token |
| Create download URL for file attachment  | `POST /attachments/{attachmentId}/download-url`                                                                 | User token |

## Example: End-to-End Flow

This example demonstrates how to use the Collaboration APIs to enable a user to
participate in a discussion:

1. [Get an application access token (for managing contexts)](#get-an-application-access-token)
1. [Create a User Group](#create-a-user-group)
1. [Create a User and associate to User Group](#create-a-user-and-associate-to-user-group)
1. [Create a collaboration context](#create-a-collaboration-context)
1. [Associate a user group with the context](#associate-a-user-group-with-the-context)
1. [Perform a token exchange for a user access token](#perform-a-token-exchange-for-a-user-access-token)
1. [Create a thread](#create-a-thread)
1. [Create a reply](#post-a-reply)

### Get an Application Access Token

Use the [Client Credentials Flow](./authentication#client-credentials) to get a token for creating and managing
collaboration contexts and user groups.

```bash
curl --location --request POST \
  --url "https://platform.vertexvis.com/oauth2/token" \
  --header "Authorization: Basic $(echo -n "[YOUR_CLIENT_ID]:[YOUR_CLIENT_SECRET]" | base64)" \
  --header "Content-Type: application/x-www-form-urlencoded" \
  --data-urlencode "grant_type=client_credentials"
```

### Create a User Group

User groups define which users can participate in a collaboration context.

```bash
curl --request POST 'https://platform.vertexvis.com/user-groups' \
  --header 'Authorization: Bearer YOUR_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json' \
  --data '{
    "data": {
      "type": "user-group",
      "attributes": {
        "name": "Design Reviewers"
      }
    }
  }'
```

### Create a User and Associate to User Group

Users must be created before they can participate in collaboration. When using
token exchange, the user's `idpId` should match the user ID from your external
identity provider.

```bash
curl --request POST 'https://platform.vertexvis.com/users' \
  --header 'Authorization: Bearer YOUR_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json' \
  --data '{
    "data": {
      "type": "user",
      "attributes": {
        "fullName": "Jane Doe",
        "email": "jane.doe@example.com",
        "idpId": "00u123example"  // Must match the user ID from your IdP
      }
    }
  }'
```

You can then assign the user to a user group:

```bash
curl --request POST 'https://platform.vertexvis.com/user-groups/YOUR_USER_GROUP_ID/users' \
  --header 'Authorization: Bearer YOUR_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json' \
  --data '{
    "data": [
      { "type": "user", "id": "YOUR_USER_ID" }
    ]
  }'
```

### Create a Collaboration Context

Create a collaboration context and save the returned context ID.

```bash
curl --request POST 'https://platform.vertexvis.com/collaboration-contexts' \
  --header 'Authorization: Bearer YOUR_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json' \
  --data '{
    "data": {
      "type": "collaboration-context",
      "attributes": {}
    }
  }'
```

### Associate a User Group with the Context

```bash
curl --request POST 'https://platform.vertexvis.com/collaboration-contexts/YOUR_CONTEXT_ID/user-groups' \
  --header 'Authorization: Bearer YOUR_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json' \
  --data '{
    "data": [
      { "type": "user-group", "id": "YOUR_USER_GROUP_ID" }
    ]
  }'
```

### Perform a Token Exchange for a User Access Token

Exchange an access token from your external identity provider (IdP) for a Vertex
access token.

```bash
curl --request POST 'https://platform.vertexvis.com/token/exchange' \
  --header 'Authorization: Basic BASE64_ENCODED_CLIENT_ID_AND_SECRET' \
  --header 'Content-Type: application/x-www-form-urlencoded' \
  --data-urlencode 'grant_type=urn:ietf:params:oauth:grant-type:token-exchange' \
  --data-urlencode 'subject_token=EXTERNAL_IDP_ACCESS_TOKEN' \
  --data-urlencode 'subject_token_type=urn:ietf:params:oauth:token-type:access_token'
```

This returns an opaque `access_token` that represents the authenticated user.
Use this `USER_ACCESS_TOKEN` for all thread and reply operations.

### Create a Thread

Create a thread save the returned thread ID.
:::note
this endpoint accepts an optional reference payload to associate reference data to scenes or other Vertex concepts.
:::

```bash
curl --request POST 'https://platform.vertexvis.com/collaboration-contexts/YOUR_CONTEXT_ID/threads' \
  --header 'Authorization: Bearer USER_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json' \
  --data '{
    "data": {
      "type": "thread",
      "attributes": {
        "body": "Gap found in left flange",
        "type": "issue",
        "status": "open"
      }
    }
  }'
```

### Create a Reply

```bash
curl --request POST 'https://platform.vertexvis.com/threads/YOUR_THREAD_ID/replies' \
  --header 'Authorization: Bearer USER_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json' \
  --data '{
    "data": {
      "type": "reply",
      "attributes": {
        "body": "We will update the CAD file to fix this issue."
      }
    }
  }'
```

## Performing Actions on Threads and Replies

These endpoints demonstrate how to update and filter your threads and replies.

1. [Update a Thread](#update-a-thread)
1. [List Threads for a Collaboration Context](#list-threads-for-a-collaboration-context)
1. [Delete a Thread](#delete-a-thread)
1. [Update a Reply](#update-a-reply)
1. [Delete a Reply](#delete-a-reply)


### Update a Thread

Updates an existing thread to modify the body, title, status or other fields. You can update the drafting state when you are ready for your thread to be visible in a list request. Any fields you do not want to change can be omitted.
Editing the title or body will result in a new field `editedAt` to be populated on the thread, that will indicate the contents of the thread have been modified. Status and drafting state will not impact the `editedAt` field.

```bash
curl --request PATCH 'https://platform.vertexvis.com/threads/YOUR_THREAD_ID' \
  --header 'Authorization: Bearer USER_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json' \
  --data '{
    "data": {
      "attributes": {
        "body": "Updated Body",
        "isDrafting": false,
        "status": "resolved",
        "title": "Updated Title"
      },
      "type": "thread"
    }
  }'
  ```


### List Threads for a Collaboration Context

  Our APIs support listing threads for a collaboration context. Filtering by the thread status is an optional query parameter to allow filtering by the thread status. 
  These endpoints enable you to filter only open or only resolved thread within your collaboration context.
```bash
curl --request GET 'https://platform.vertexvis.comthreads?filter[collaborationContextId]=YOUR_CONTEXT_ID&filter[threadStatus]=resolved' \
  --header 'Authorization: Bearer USER_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json'
  ```


### Delete a Thread

If you wish to delete your thread instead of updating the state to resolved, this endpoint allows you to permanently delete the thread and all of its replies.

```bash
curl --request DELETE 'https://platform.vertexvis.com/threads/YOUR_THREAD_ID' \
  --header 'Authorization: Bearer USER_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json'
  ```

### Update a Reply

Editing the body of a reply will result in a new field `editedAt` to be populated on the reply, this field indicates that the reply has been modified from its original state. Drafting state will not impact the `editedAt` field.

```bash
curl --request PATCH 'https://platform.vertexvis.com/replies/YOUR_REPLY_ID' \
  --header 'Authorization: Bearer USER_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json' \
  --data '{
    "data": {
      "attributes": {
        "body": "Updated reply body",
        "isDrafting": false
      },
      "type": "reply"
    }
  }'
```

### Delete a Reply

Allows the owning user to permanently delete a reply

```bash
curl --request DELETE 'https://platform.vertexvis.com/replies/YOUR_REPLY_ID' \
  --header 'Authorization: Bearer USER_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json'
  ```


## Thread and Reply Attachments
:::note
 When building applications that leverage attachments, it is recommended to set your thread as drafted so that you can handle the asynchronous upload of your file data prior to your thread being visible to other users.
:::

1. [Create an Attachment](#create-an-attachment)
1. [List Attachments](#list-attachments)
1. [Create Upload Url For Attachment](#create-upload-url-for-attachment)
1. [Upload file with url](#upload-file-with-url)
1. [Create Download Url For Attachment](#create-download-url-for-attachment)


### Create an Attachment

Create an attachment to be associated to either a reply or a thread. That relationship is specified within the request body.
The with-content is a oneOf type that may change in the future to support additional types of attachments. 

```bash
curl --request POST 'https://platform.vertexvis.com/attachments' \
  --header 'Authorization: Bearer USER_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json' \
  --data '{
    "data": {
      "type": "attachment",
      "attributes": {
        "withContent": {
          "type": "file-content",
          "name": "The name of your file"
        }
      },
      "relationships": {
        "context": { "type": "thread", "id": "YOUR_THREAD_ID" }
      }
    }
  }'
```

### List Attachments

Returns the attachments for a thread or a reply

```bash
curl --request GET 'https://platform.vertexvis.com/attachments?filter[relationshipId]={threadOrReplyId}&filter[relationshipType]=threadOrReply' \
  --header 'Authorization: Bearer USER_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json'
```

### Create Upload Url For Attachment

Creates an upload url for an attachment. This requires that the attachment is of `type`.
The authoring user of the attachment is the only user allowed to create an upload url.

```bash
curl --request POST 'https://platform.vertexvis.com/attachments/{attachmentId}/upload-url' \
  --header 'Authorization: Bearer USER_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json' \
  --data '{
    "data": {
        "type": "upload-url",
        "attributes": {
            "expiry": 3600
        }
    }
}'
```

### Upload file with URL

Upload the file with the returned upload URL by performing a PUT request with the file you want to upload.

```bash
curl --location --request PUT '{UPLOAD_URL}' \
  --data-binary '@/path/to/file'
```


### Create Download Url For Attachment

Creates a download url for an attachment. This requires that the attachment is of `type`.
Anyone who has access to the Collaboration Context will have the ability to create a download url.

```bash
curl --request POST 'https://platform.vertexvis.com/attachments/{attachmentId}/download-url' \
  --header 'Authorization: Bearer USER_ACCESS_TOKEN' \
  --header 'Content-Type: application/vnd.api+json' \
  --data '{
    "data": {
        "type": "download-url",
        "attributes": {
            "expiry": 3600
        }
    }
}'
```
